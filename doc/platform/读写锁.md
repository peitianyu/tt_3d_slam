## 读写锁

### 设计思路

```txt
1. 构造读写锁时可以参考多线程读写锁设计思路(https://blog.csdn.net/qq_35865125/article/details/110149082)
2. 将互斥锁改为信号量使用
3. 根据不同topic, 生成不同读写信号量
```

### 代码设计(程序测试将结合读写者一块测试)

```c++
// 代码应该包含四个部分:
// 读加锁, 读解锁, 写加锁, 写解锁

void RWLock::ReadLock() {
    // 等待信号量的值大于零，然后将其减一
    tt_assert(sem_wait(sem_read_ptr_) != -1);

    // 等待信号量的值大于零，然后将其减一
    tt_assert(sem_wait(sem_write_ptr_) != -1);

    // 将信号量的值加一
    tt_assert(sem_post(sem_write_ptr_) != -1);
}

void RWLock::ReadUnlock() {
    // 将信号量的值加一
    tt_assert(sem_post(sem_read_ptr_) != -1);
}

void RWLock::WriteLock() {
    // 等待信号量的值大于零，然后将其减一
    tt_assert(sem_wait(sem_write_ptr_) != -1);
}

void RWLock::WriteUnlock() {
    // 将信号量的值加一
    tt_assert(sem_post(sem_write_ptr_) != -1);
}
```
